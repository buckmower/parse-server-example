<!DOCTYPE html>
   <!--[if lt IE 7]> <html class="ie ie6 lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
   <!--[if IE 7]>    <html class="ie ie7 lt-ie9 lt-ie8"        lang="en"> <![endif]-->
   <!--[if IE 8]>    <html class="ie ie8 lt-ie9"               lang="en"> <![endif]-->
   <!--[if IE 9]>    <html class="ie ie9"                      lang="en"> <![endif]-->
   <!--[if !IE]><!-->
   <html lang="en" class="no-ie">
   <!--<![endif]-->
   
   <head>
      <!-- Meta-->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
      <meta name="description" content="Voter Dashboard">
      <meta name="keywords" content="vote, election, group, sphere, nominate, decide">
      <meta name="author" content="<%= username %>">
      <!-- Desktop Browsers -->
      <link rel="shortcut icon" type="image/x-icon" href="assets/icons/favicon.ico" />
      
      <!-- Android: Chrome M39 and up-->
      <link rel="manifest" href="assets/icons/manifest.json">
      <!-- Android: Chrome M31 and up, ignored if manifest is present-->
      <meta name="mobile-web-app-capable" content="yes">
      <link rel="icon" sizes="192x192" href="assets/icons/icon-192x192.png">
      <!-- iOS -->
      <meta name="apple-mobile-web-app-capable" content="yes">
      <meta name="apple-mobile-web-app-title" content="Represent.xyz">
      
      <link rel="apple-touch-icon" sizes="180x180" href="assets/icons/apple-touch-icon-180x180-precomposed.png">
      <link href="assets/icons/apple-touch-icon-152x152-precomposed.png" sizes="152x152" rel="apple-touch-icon">
      <link href="assets/icons/apple-touch-icon-144x144-precomposed.png" sizes="144x144" rel="apple-touch-icon">
      <link href="assets/icons/apple-touch-icon-120x120-precomposed.png" sizes="120x120" rel="apple-touch-icon">
      <link href="assets/icons/apple-touch-icon-114x114-precomposed.png" sizes="114x114" rel="apple-touch-icon">
      <link href="assets/icons/apple-touch-icon-76x76-precomposed.png" sizes="76x76" rel="apple-touch-icon">
      <link href="assets/icons/apple-touch-icon-72x72-precomposed.png" sizes="72x72" rel="apple-touch-icon">
      <link href="assets/icons/apple-touch-icon-60x60-precomposed.png" sizes="60x60" rel="apple-touch-icon">
      <link href="assets/icons/apple-touch-icon-57x57-precomposed.png" sizes="57x57" rel="apple-touch-icon">
      <link href="assets/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon">
      
      <!-- Windows 8 and IE 11 -->
      <meta name="msapplication-config" content="assets/icons/browserconfig.xml" />
      
      <!-- Windows -->
      <meta name="application-name" content="Represent.xyz" />
      <meta name="msapplication-tooltip" content="Let's Make Decisions Together!" />
      <meta name="msapplication-window" content="width=1024;height=768" />
      <meta name="msapplication-navbutton-color" content="#007EFF" />
      <meta name="msapplication-starturl" content="./" />
      <title>Represent.xyz | Voter Dashboard</title>
      <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script><script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script><![endif]-->
      <!-- Bootstrap CSS-->
      <link rel="stylesheet" href="admin/app/css/bootstrap.css">
      <!-- Vendor CSS-->
      <link rel="stylesheet" href="admin/app/vendor/fontawesome/css/font-awesome.min.css">
      <!-- START Page Custom CSS-->
      <style>
      #logorepred {
        color: #ed0027;
      }
      #logoresblack {
        color: #333333;
      }
      #logoentblue {
        color: #007eff;
      }
      .brand-logo {
        font-size: 28pt;
      }
      </style>
      <!-- END Page Custom CSS-->
      <!-- App CSS-->
      <link rel="stylesheet" href="admin/app/css/app.css">
      <!-- JavaScript Files -->
      <!-- JQuery -->
      <script src="admin/app/vendor/jquery/jquery.min.js"></script>
      <script src="admin/app/vendor/moment/min/moment.min.js"></script>
      <script src="admin/app/vendor/countdown/jquery.countdown.js"></script>
      <!-- Google Analytics -->
      <script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		
		  ga('create', 'UA-61425849-1', 'auto');
		  ga('send', 'pageview');
		
	  </script>
	  <script>
	     $(document).ready(function(){
	        $(".showRecordButton").click(function(){
	           $("#recordlist").children().remove();
	           var electionnamevotedin = $(this).data("electionname");
	           var nominationsvotedfor = $(this).data("nominationsvotedfor");
	           var electionurl = $(this).data("urlofelection");
	           var electionEndDateUnix = $(this).data("electionenddateunix");
	           var electionObjectID = $(this).data("electionobjectid");
	           var sphereObjectID = $(this).data("sphereobjectid");
	           var nowdatetimeunix = moment().unix();
	           if(nowdatetimeunix < electionEndDateUnix){
	              var votedeleteoption = "badge deleteActiveUserVoteButton";
	              var listitemicon = "X";
	              $("#stateofending").html("Active Election");
	           } else {
	              var votedeleteoption = "";
	              var listitemicon = "";
	              $("#stateofending").html("Voting Has Ended");
	           }
	           $("#gotoelection").attr("href", electionurl);
	           $("#yourrecordin").html(electionnamevotedin);
	           var nominationsvotedforarray = new Array();
	           if(nominationsvotedfor !== false) {
   	           for(var i = 0; i < nominationsvotedfor.length; i++){
   	              var nominationvotedforobject = nominationsvotedfor[i];
   	              if(nominationvotedforobject !== false) {
   	                 var voteObjectID = nominationvotedforobject['voteid'];
   	                 $("#recordlist").append("<li style='padding: 10px 0px;'><span style='cursor: pointer; color: #FF0000;' class='"+votedeleteoption+"' data-sphereobjectid='"+sphereObjectID+"' data-electionobjectid='"+electionObjectID+"' data-voteobjectid='"+voteObjectID+"'>"+listitemicon+"</span>"+nominationvotedforobject['pageName']+" - "+nominationvotedforobject['votes'] +"</li>");
   	              }
   	           }
	           } else {
	              $("#recordlist").append("<li>You Haven't Cast A Vote In This Election!</li>");
	           }
	           if((nominationsvotedfor.length <= 1) && (nominationsvotedfor[0] == false)){
	              $("#recordlist").append("<li>You Haven't Cast A Vote In This Election!</li>");
	           }
	           $(".deleteActiveUserVoteButton").one("click", function() {
               if (!confirm("Do you want to delete this vote?")){
                   return false;
               } else {
                    $.post("/votes/takevoteback", 
                       { sphereObjectID: $(this).data("sphereobjectid"),
                         electionObjectID: $(this).data("electionobjectid"),
                         nominationObjectID: $(this).data("nominationobjectid"),
                         voteObjectID: $(this).data("voteobjectid") 
                       },
                       function()
                           { 
                               location.reload(true);
                           }
                     );
               }
              });
	           $("#showRecordModal").modal("show");
	        });
	     });
	  </script>
   </head>
<body class="">
   <div id="fb-root"></div>
   <% include /settings %>
   <div class="modal fade" id="showRecordModal">
     <div class="modal-dialog">
       <div class="modal-content">
         <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
           <h4 class="modal-title" id="stateofending"></h4>
         </div>
         <div class="modal-body" style="overflow: scroll;">
           <h3 id="yourrecordin"></h3>
           <ul id="recordlist" style="list-style-type: none; padding-left: 0px;">
              
           </ul>
         </div>
         <div class="modal-footer">
           <a id="gotoelection" class="btn btn-primary pull-left" href="">Go To Election</a>
           <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
         </div>
       </div><!-- /.modal-content -->
     </div><!-- /.modal-dialog -->
   </div><!-- /.modal -->
   <!-- START Main wrapper-->
      <section class="wrapper">
         <!-- START Top Navbar-->
         <nav role="navigation" class="navbar navbar-default navbar-top navbar-fixed-top">
            <!-- START navbar header-->
            <div class="navbar-header" style="background-color: #ffffff;">
               <a href="#" class="navbar-brand">
                  <div class="brand-logo"><span id="logorepred">rep</span><span id="logoresblack">res</span><span id="logoentblue">ent</span>.xyz</div>
                  <div class="brand-logo-collapsed"><img class="img img-responsive" src="assets/icons/apple-touch-icon-57x57-precomposed.png"></div>
               </a>
            </div>
            <!-- END navbar header-->
            <!-- START Nav wrapper-->
            <div class="nav-wrapper">
               <!-- START Left navbar-->
               <ul class="nav navbar-nav">
                  <li>
                     <a href="#" data-toggle="aside">
                        <em class="fa fa-align-left"></em>
                     </a>
                  </li>
               </ul>
               <!-- END Left navbar-->
               <!-- START Right Navbar-->
               <ul class="nav navbar-nav navbar-right">
                  <!-- START Alert menu-->
                  <li class="dropdown">
                           <a href="javascript:void(0);" data-toggle="dropdown" data-play="bounceIn" class="dropdown-toggle" aria-expanded="false">
                              <em class="fa fa-user"></em>
                           </a>
                           <!-- START Dropdown menu-->
                           <ul class="dropdown-menu" style="">
                              <li style="padding: 20px 10px;"><a href="/me">
                                 <em class="fa fa-cog text-muted"></em>Settings</a>
                              </li>
                              <li style="padding: 20px 10px;"><a href="/logout">
                                 <em class="fa fa-sign-out text-muted"></em>Logout</a>
                              </li>
                           </ul>
                           <!-- END Dropdown menu-->
                        </li>
                     </ul>
                     <!-- END Dropdown menu-->
                  </li>
                  <!-- END Alert menu-->
                  <!-- END User menu-->
                  <!-- START Contacts button-->
                  <!-- <li>
                     <a href="#" data-toggle="offsidebar">
                        <em class="fa fa-align-right"></em>
                     </a>
                  </li> -->
                  <!-- END Contacts menu-->
               </ul>
               <!-- END Right Navbar-->
            </div>
            <!-- END Nav wrapper-->
         </nav>
         <aside class="aside">
         <!-- START Sidebar (left)-->
         <nav class="sidebar" style="overflow: auto;">
            <ul class="nav">
               <!-- START user info-->
               <li>
                  <div class="item user-block" id="userProfile">
                     <!-- User picture-->
                     <% if(userprofileimageurl !== null) { %>
                     <div class="user-block-picture">
                        <img src="<%= userprofileimageurl %>" alt="<%= username %>" width="60" height="60" class="img-thumbnail img-circle">
                     </div>
                     <% } %>
                     <!-- Name and Role-->
                     <div class="user-block-info">
                        <span class="user-block-name"><%= username %></span>
                     </div>
                  </div>
               </li>
               <!-- END user info-->
               <!-- START Menu-->
               <li class="">
                  <a href="/spheres" title="spheres">
                     <em class="fa fa-circle"></em>
                     <div class="label label-primary pull-right"><%= numberofuserspheres %></div>
                     <span class="item-text" style="padding-right: 15px;">Spheres</span>
                  </a>
               </li>
               <li class="">
                  <a href="/votes" title="votes">
                     <em class="fa fa-star"></em>
                     <div class="label label-primary pull-right"><%= numberofuservotescast %></div>
                     <span class="item-text" style="padding-right: 15px;">Votes</span>
                  </a>
               </li>
               <li class="">
                  <a href="/admin" title="admin">
                     <em class="fa fa-lock"></em>
                     <div class="label label-primary pull-right"><%= numberofadminactionitems %></div>
                     <span class="item-text" style="padding-right: 15px;">Admin</span>
                  </a>
               </li>
               <li class="">
                  <a href="/decisions" title="decisions">
                     <em class="fa fa-compass"></em>
                     <div class="label label-primary pull-right"><%= numberofdecisions %></div>
                     <span class="item-text" style="padding-right: 15px;">Decisions</span>
                  </a>
               </li>
               <!-- END Menu-->
               <!-- Sidebar footer -->
               <li class="nav-footer">
                  <div class="nav-footer-divider"></div>
                  <!-- START button sphere-->
                  <div class="btn-sphere text-center">
                     <a href="/me" type="button" data-toggle="tooltip" data-title="Settings" class="btn btn-link">
                        <em class="fa fa-cog text-muted"></em>
                     </a>
                     <a href="/logout" type="button" data-toggle="tooltip" data-title="Logout" class="btn btn-link">
                        <em class="fa fa-sign-out text-muted"></em>
                     </a>
                  </div>
                  <!-- END button sphere-->
               </li>
            </ul>
         </nav>
         <!-- END Sidebar (left)-->
      </aside>
      <!-- End aside-->
      <!-- START Main section-->
      <section>
         <!-- START Page content-->
         <section class="main-content" style="min-height: 600px;">
         <%
         if(notifications.length >= 1) {
          for(var i = 0; i < notifications.length; i++) {
           if(((notifications.length < 4) && (i == notifications.length)) || ((i !== 0) && ((i%4) == 0)) || ((notifications.length > 4) && ((i !== 0) && ((i%4) == 0)) && (i == notifications.length))) { %>
                </div>      
            <%   }
            if((i == 0) || ((i%4)) == 0) { %>
            <div class="row">      
            <%   }
               var votesinelectionobject = notifications[i]['votesinelection'];
               if((votesinelectionobject == false) || (votesinelectionobject.length <= 0)){
                  var noticeicon = "fa-flag";
                  var voterecord = false;
               } else {
                  if((votesinelectionobject.length <= 1) && (votesinelectionobject[0] == false)){
                     var noticeicon = "fa-flag"
                     var voterecord = false;
                  } else {
                     var noticeicon = "fa-star";
                     var voterecordinfo = new Array();
                     for(var i2 = 0; i2 < votesinelectionobject.length; i2++) {
                        var votesinfo = votesinelectionobject[i2];
                        for(var i3 = 0; i3 < votesinfo.length; i3++){
                           var pageName = votesinfo[i3].get("pageName");
                           var votesCast = votesinfo[i3].get("votes");
                           var voteid = votesinfo[i3].id;
                           voterecordinfo.push({"pageName": pageName, "votes": votesCast, "voteid": voteid});
                        }
                     }
                     var voterecord = JSON.stringify(voterecordinfo);
                  }
               }
               var nowdatetimeunix = ((new Date).getTime() / 1000);
               if(nowdatetimeunix < notifications[i]['election'].electionEndDateUnix){
                  var noticebg = "bg-info";
               } else {
                  var noticebg = "bg-danger";
               }
         %>
               <div class="col-lg-3">
                  <!-- START widget-->
                  <div class="panel widget showRecordButton" style="cursor: pointer;" data-sphereobjectid="<%= notifications[i]['election'].sphereObjectID %>" data-electionobjectid="<%= notifications[i]['election'].electionObjectID %>" data-electionenddateunix="<%= notifications[i]['election'].electionEndDateUnix %>" data-urlofelection="/sphere/<%= notifications[i]['election'].sphereObjectID %>/election/<%= notifications[i]['election'].electionObjectID %>" data-nominationsvotedfor="<%= voterecord %>" data-electionname="<%= notifications[i]['election'].electionName %>">
                     <div class="row row-table row-flush">
                        <div class="col-xs-4 <%= noticebg %> text-center">
                           <em class="fa <%= noticeicon %> fa-2x"></em>
                        </div>
                        <div class="col-xs-8">
                           <div class="panel-body text-center">
                              <h4 class="mt0"><%= notifications[i]['election'].nominations.length %> Nominees</h4>
                              <p class="mb0 text-muted"><%= notifications[i]['election'].electionName %></p>
                           </div>
                        </div>
                     </div>
                  </div>
                  <!-- END widget-->
               </div>
            <%   }  
            } else { %>
            <h2>Your Voter Dashboard Is Empty</h2><br><br>
            <a href="/spheres" class="btn btn-lg btn-primary">Join Spheres To Get Started</a>
           <% } %>
            <!-- END timeline -->
         </section>
         <!-- END Page content -->
      </section>
      <!-- END Main section -->
   </section>
   <!-- END Main wrapper -->
   <!-- START Scripts -->
   <!-- Main vendor Scripts -->
   <script src="admin/app/vendor/bootstrap/js/bootstrap.min.js"></script>
   <!-- App Main-->
   <script src="admin/app/js/profile.js"></script>
   <script>
      $(document).ready(function() {
         $("#inviteFriends").click(function() {
            window.top.location.href = 'https://www.facebook.com/dialog/apprequests?app_id=487409348027542&message=Have%20You%20Checked%20Your%20Stats%20Recently%3F&redirect_uri=https://www.represent.xyz/profile';
         });
         $("#userProfile").click(function() {
            window.location.href = '/profile';
         });
      });
   </script>
   <script>
      $(document).ready(function(){
         moment().unix();
         var timesinceuserjoined = (<%= timeuserjoined %> - moment().unix());
         var timeuserjoinedhumanized = moment.duration(timesinceuserjoined, "s").humanize(true);
         $("#timeuserjoined").attr("datetime", timeuserjoinedhumanized);
         $(".timeofnotification").each(function(){
            var timesincenotificationunix = $(this).data("unixdate");
            var timesincenotification = (timesincenotificationunix - moment().unix());
            var timeofnotificationhumanized = moment.duration(timesincenotification, "s").humanize(true);
            $(this).attr("datetime", timeofnotificationhumanized);
         });
         $(".endDate").each(function(){
            var enddate = $(this).data("enddate");
            var endformattedforcountdown = moment(enddate).format('L HH:mm:ss');
            var endformattedforfinish = moment(enddate).format('L hh:mm a');
            $(this).countdown(endformattedforcountdown, function(event) {
               $(this).not(".popover-title").text(event.strftime('ends in %D days %H hours %M minutes and %S seconds.'));
            }).on('finish.countdown', function(event) {
               $(this).not(".popover-title").html('The Results Are In! The election ended '+ endformattedforfinish);
               if($(document).width() < 700) {
                   $(this).find(".badge").html(" Resolved ");
               }
            });
         });
         $(".election").click(function(){
            var urlofelection = $(this).data("urlofelection");
            window.location.assign(urlofelection);
         });
         if($(document).width() < 700) {
           $("#listofnotifications").removeClass("timeline").css({"list-style-type": "none", "margin-left": "0px", "padding-left": "0px"});
           $(".timeline-badge").children().remove();
           $(".timeline-badge").removeClass("timeline-badge");
           $(".endDate").not(".popover-title").hide();
           $(".timeline-date").removeClass();
           $(".electionenddatediv").hide();
           $(".electiontitle").css("font-size", "12pt");
           $(".timeline-panel").removeClass("timeline-panel");
           $(".electionitem").removeClass("timeline-inverted").css({"background-color": "#fff", "padding": "10px 0px", "margin": "10px 0px", "width": "100%"});
           $(".popover").removeClass();
           $(".arrow").hide();
           $(".popover-content").removeClass();
         }
      });
   </script>
   </body>
 
</html>